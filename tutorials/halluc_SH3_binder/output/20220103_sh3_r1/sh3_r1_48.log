/mnt/home/dzorine/software/homog/homog/homog.py:98: SyntaxWarning: "is" with a literal. Did you mean "=="?
  if degrees is 'auto': degrees = guess_is_degrees(angle)
[20:57:32] /opt/dgl/src/runtime/tensordispatch.cc:43: TensorDispatcher: dlopen failed: libtorch_cuda_cpp.so: cannot open shared object file: No such file or directory
Using backend: pytorch
--steps was given. Ignoring --grad_steps, --mcmc_steps.

Run settings:
{'network_name': 'rf_Nov05_2021', 'use_template': None, 'num': 2, 'start_num': 48, 'msa_num': 1, 'out': '/mnt/home/jue/halluc/linear_motifs/output/20220103_sh3_r1/sh3_r1', 'cautious': 1, 'save_pdb': 1, 'save_batch_fas': False, 'track_step': 10, 'track_logits': False, 'out_step': None, 'seed_rng': False, 'steps': 'g600', 'grad_steps': 400, 'mcmc_steps': 0, 'optimizer': 'nsgd', 'drop': 0.2, 'init_sd': 1e-06, 'learning_rate': 0.05, 'grad_check': True, 'logit_scale': 1, 'seq_prob_type': 'hard', 'seq_sample': False, 'calc_bkg': True, 'cce_sd': None, 'hal_sd': None, 'corrupt_sequence': None, 'corrupt_fraction': None, 'pdb': '/mnt/home/jue/halluc/linear_motifs/input/SH3_2w0z.pdb', 'mask': None, 'contigs': 'B7-14', 'con_set_id': None, 'len': '55-100', 'keep_order': False, 'contig_min_gap': 5, 'spike': None, 'spike_fas': None, 'force_aa': 'B7-14', 'exclude_aa': 'C', 'force_aa_hal': None, 'template_pdbs': None, 'no_bkg_mask': False, 'num_repeats': 0, 'init_seq': None, 'masks_bkg': None, 'masks_pass': None, 'force_logits': None, 'receptor': None, 'rec_placement': 'second', 'gap': 200, 'w_cce': 1, 'w_crmsd': -1, 'w_entropy': 1, 'w_kl': -1, 'n_bkg': 100, 'w_rep': 2.0, 'w_set_rep': -1, 'w_atr': -1, 'w_set_atr': -1, 'w_rog': 1.0, 'w_aspect_ratio': -1, 'w_cyc_sym': -1, 'w_surfnp': -1, 'w_nc': -1, 'w_cce_bg': -1, 'w_sym': -1, 'cce_cutoff': 19.9, 'rep_pdb': 'input/SH3_2w0z_rec.pdb', 'rep_sigma': 3.5, 'atr_pdb': None, 'atr_sigma': 5, 'entropy_beta': 10, 'rog_thresh': 16.0, 'surfnp_nbr_thresh': 2.5, 'nc_target': -7, 'entropy_dist_bins': 16, 'mcmc_halflife': 500.0, 'T_acc_0': 0.002, 'mcmc_batch': 1, 'anneal_t1d': False, 'erode_template': False, 'num_masked_tokens': 1, 'weights_dir': '/projects/ml/trDesign', 'nthreads': 4, 'cce_cutstep': None, 'cce_thresh': 2.2, 'batch': 64, 'lr': 0.2, 'nsteps': 100, 'commit': 'c344913efafbbfe8f452574b0c86c348792a5045'}

Loading structure prediction model onto device cuda:0...
#   trunk_msa_v00     [ens=1]   AF2-inspired 12-block 2-track trunk
#   trunk_tbm_v00     [ens=1]   AF2-inspired 3-track trunk
#   rf_v00            [ens=1]   RoseTTAFold 3-track trunk + refiner (formerly trunk_e2e_v00)
# * rf_Nov05_2021     [ens=1]   RoseTTAFold 3-track, no perceiver, Nov. 5 2021
#   rf_perceiver_v00  [ens=1]   RoseTTAFold w/ Perceiver & FAPE loss (msa_full=zeros)
#   rf_perceiver_v01  [ens=1]   RoseTTAFold w/ Perceiver & FAPE loss (msa_full=msa_latent)
#   af2_v00           [ens=0]   AlphaFold2 (only works with rescue.py)
Loaded sequence-to-structure model rf_Nov05_2021 with 66037142 parameters

Model hyperparameters:
{'SE3_param': {'div': 4, 'l0_in_features': 32, 'l0_out_features': 32, 'l1_in_features': 3, 'l1_out_features': 2, 'n_heads': 4, 'num_channels': 32, 'num_degrees': 2, 'num_edge_features': 32, 'num_layers': 3}, 'd_hidden': 32, 'd_hidden_templ': 64, 'd_msa': 256, 'd_msa_full': 64, 'd_pair': 128, 'd_templ': 64, 'n_head_msa': 8, 'n_head_pair': 4, 'n_head_templ': 4, 'n_module_2track': 24, 'n_module_3track': 8, 'p_drop': 0.0}

Using CUDA device(s):  cuda:0: (GeForce RTX 2080); 

Parsing input pdb...

Generating sh3_r1_48, length 78...
Forcing amino acids:  B7P,B8P,B9P,B10R,B11P,B12P,B13K,B14P
Loss term           | Weight      
cce                   1.00
entropy               1.00
rep                   2.00
rog                   1.00

Stage 0
Starting gradient descent...
        step    avg loss         cce     entropy         rep         rog
           0      1.4115      1.7817      2.9484      0.8369      0.6534
          10      1.1071      1.7660      2.9570      0.3993      0.0138
          20      0.8925      1.6158      2.8362      0.0022      0.0059
          30      0.9210      1.5720      2.9354      0.0000      0.0976
          40      1.5428      1.6145      2.7876      0.0000      3.3117
          50      0.9385      1.5921      2.7782      0.0000      0.3220
          60      0.9656      1.6434      2.8122      0.0555      0.2612
          70      1.3031      1.6331      2.7755      0.9667      0.1735
          80      0.8608      1.6240      2.6616      0.0000      0.0186
          90      0.8176      1.6246      2.4385      0.0028      0.0194
         100      0.8616      1.6196      2.6479      0.0003      0.0398
         110      0.7898      1.6106      2.3270      0.0001      0.0112
         120      0.9555      1.5700      2.3421      0.4282      0.0088
         130      0.8407      1.6455      2.5402      0.0000      0.0176
         140      0.8378      1.5613      2.3732      0.0934      0.0675
         150      0.7928      1.6528      2.2787      0.0112      0.0102
         160      0.8155      1.5808      2.4871      0.0000      0.0094
         170      0.7937      1.5525      2.3896      0.0000      0.0261
         180      0.8577      1.6762      2.5426      0.0003      0.0689
         190      0.7540      1.5816      2.1793      0.0000      0.0092
         200      0.7874      1.5604      2.3240      0.0163      0.0198
         210      0.7779      1.5776      2.3030      0.0000      0.0090
         220      0.7682      1.6183      2.2060      0.0024      0.0117
         230      0.7452      1.5119      2.1968      0.0001      0.0172
         240      0.7586      1.5101      2.2704      0.0000      0.0123
         250      0.7750      1.6036      2.2538      0.0000      0.0177
         260      0.7922      1.6229      2.3223      0.0003      0.0153
         270      0.7449      1.4893      2.2116      0.0000      0.0234
         280      0.7467      1.4559      2.2561      0.0000      0.0215
         290      0.7601      1.5985      2.1872      0.0004      0.0144
         300      0.7826      1.5215      2.3772      0.0000      0.0145
         310      0.7757      1.6421      2.2242      0.0008      0.0107
         320      0.7545      1.5515      2.2040      0.0000      0.0168
         330      0.7808      1.6128      2.2792      0.0007      0.0107
         340      0.7220      1.5412      2.0554      0.0004      0.0127
         350      0.7200      1.5262      2.0577      0.0000      0.0160
         360      0.7193      1.4697      2.1120      0.0000      0.0146
         370      0.8302      1.6742      2.4497      0.0007      0.0256
         380      0.7159      1.4350      2.1273      0.0000      0.0171
         390      0.7271      1.5628      2.0614      0.0000      0.0111
         400      0.7778      1.5814      2.2919      0.0002      0.0152
         410      0.7179      1.5198      2.0484      0.0017      0.0177
         420      0.7556      1.5160      2.2415      0.0003      0.0199
         430      0.7934      1.5723      2.3753      0.0000      0.0192
         440      0.7312      1.5370      2.1003      0.0000      0.0186
         450      0.7642      1.5688      2.2390      0.0000      0.0132
         460      0.8396      1.6309      2.5532      0.0000      0.0138
         470      0.7310      1.5765      1.9892      0.0378      0.0135
         480      0.8479      1.5538      2.6161      0.0000      0.0697
         490      0.8325      1.5962      2.5473      0.0000      0.0191
         500      0.7116      1.5016      2.0422      0.0000      0.0143
         510      0.8028      1.5705      2.4367      0.0000      0.0068
         520      0.7845      1.5910      2.3195      0.0000      0.0118
         530      0.7517      1.5014      2.2402      0.0000      0.0171
         540      0.8609      1.6146      2.4686      0.1014      0.0182
         550      0.7695      1.4908      2.3421      0.0001      0.0141
         560      0.7143      1.4501      2.0997      0.0000      0.0220
         570      0.7818      1.5843      2.2961      0.0000      0.0285
         580      0.7500      1.4385      2.2886      0.0000      0.0227
         590      0.8334      1.5364      2.3653      0.0000      0.2653
         600      0.8387      1.5956      2.4189      0.0000      0.1791
       final      0.6753      1.3645      1.9997      0.0000      0.0125
best loss step: 573
Max CUDA memory: 1.1405G
Saving /mnt/home/jue/halluc/linear_motifs/output/20220103_sh3_r1/sh3_r1_48: npz, fas, trb, trk, trfold pdb
Finished design /mnt/home/jue/halluc/linear_motifs/output/20220103_sh3_r1/sh3_r1_48 in 14.43 minutes.

Generating sh3_r1_49, length 80...
Forcing amino acids:  B7P,B8P,B9P,B10R,B11P,B12P,B13K,B14P
Loss term           | Weight      
cce                   1.00
entropy               1.00
rep                   2.00
rog                   1.00

Stage 0
Starting gradient descent...
        step    avg loss         cce     entropy         rep         rog
           0      1.2964      1.7254      2.9824      0.3229      1.1284
          10      1.0093      1.6182      2.9223      0.2509      0.0039
          20      0.9205      1.5787      2.9532      0.0000      0.0705
          30      1.2571      1.5446      2.9221      0.6071      0.6045
          40      0.8999      1.5827      2.8752      0.0180      0.0057
          50      0.8914      1.5776      2.8364      0.0018      0.0394
          60      1.1793      1.5297      2.6898      0.8237      0.0295
          70      1.0336      1.6199      2.7865      0.3665      0.0285
          80      1.6384      1.6496      2.7801      1.8698      0.0227
          90      0.8656      1.5517      2.7443      0.0026      0.0268
         100      0.8122      1.5630      2.4754      0.0000      0.0228
         110      0.8016      1.4745      2.4933      0.0079      0.0247
         120      0.8189      1.4769      2.6010      0.0006      0.0154
         130      0.8221      1.5320      2.5443      0.0000      0.0341
         140      0.7707      1.4954      2.3276      0.0000      0.0305
         150      0.8886      1.5350      2.6291      0.1282      0.0225
         160      0.8168      1.5471      2.4764      0.0188      0.0231
         170      0.8245      1.7725      2.3264      0.0001      0.0234
         180      0.7334      1.4673      2.1602      0.0060      0.0276
         190      0.7960      1.5798      2.3750      0.0001      0.0249
         200      0.7352      1.4054      2.2456      0.0000      0.0250
         210      0.7694      1.4542      2.3590      0.0000      0.0336
         220      0.7602      1.4548      2.3219      0.0000      0.0243
         230      0.7585      1.4939      2.2697      0.0000      0.0290
         240      0.7282      1.4307      2.1885      0.0000      0.0218
         250      0.7395      1.4312      2.2366      0.0000      0.0295
         260      0.7923      1.6598      2.2717      0.0000      0.0302
         270      0.7665      1.5761      2.2108      0.0102      0.0253
         280      0.8303      1.4657      2.3218      0.1698      0.0245
         290      0.7894      1.4741      2.3947      0.0198      0.0388
         300      0.7668      1.3869      2.3888      0.0000      0.0584
         310      0.7836      1.5205      2.3206      0.0069      0.0630
         320      0.7511      1.3802      2.3089      0.0202      0.0260
         330      0.8401      1.4610      2.7244      0.0025      0.0100
         340      0.7927      1.4669      2.4789      0.0000      0.0175
         350      0.8442      1.6130      2.5750      0.0000      0.0331
         360      0.7949      1.5271      2.4185      0.0000      0.0287
         370      0.7687      1.4510      2.3665      0.0000      0.0260
         380      0.7084      1.3936      2.1199      0.0000      0.0286
         390      0.7966      1.5043      2.3044      0.0748      0.0248
         400      0.8823      1.4430      2.6655      0.0000      0.3031
         410      0.7907      1.5473      2.3840      0.0014      0.0194
         420      0.7798      1.4727      2.3216      0.0408      0.0231
         430      0.7666      1.5321      2.2733      0.0000      0.0275
         440      0.7459      1.4219      2.2836      0.0008      0.0221
         450      0.8202      1.4409      2.5851      0.0195      0.0358
         460      0.7533      1.5230      2.2070      0.0015      0.0335
         470      0.7915      1.4513      2.4884      0.0000      0.0177
         480      0.7608      1.5024      2.2786      0.0001      0.0229
         490      0.7239      1.3385      2.2552      0.0000      0.0258
         500      0.7548      1.4728      2.2628      0.0077      0.0228
         510      0.7393      1.4444      2.2253      0.0004      0.0259
         520      0.7300      1.4421      2.1461      0.0166      0.0288
         530      0.7337      1.4013      2.2271      0.0082      0.0236
         540      0.7148      1.3826      2.1678      0.0001      0.0233
         550      0.8329      1.4280      2.7023      0.0000      0.0342
         560      0.8097      1.5153      2.5000      0.0053      0.0226
         570      1.3138      1.4162      2.5976      1.2716      0.0121
         580      0.7511      1.5015      2.2217      0.0034      0.0256
         590      0.7470      1.4716      2.2364      0.0000      0.0269
         600      0.8371      1.4303      2.2422      0.2392      0.0347
       final      0.7023      1.3334      2.0978      0.0269      0.0266
best loss step: 567
Max CUDA memory: 1.1836G
Saving /mnt/home/jue/halluc/linear_motifs/output/20220103_sh3_r1/sh3_r1_49: npz, fas, trb, trk, trfold pdb
Finished design /mnt/home/jue/halluc/linear_motifs/output/20220103_sh3_r1/sh3_r1_49 in 14.54 minutes.
